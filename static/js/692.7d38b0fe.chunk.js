"use strict";(self.webpackChunkreact_main=self.webpackChunkreact_main||[]).push([[692],{1692:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Ut});var o=r(5043),n=r(2166),s=r(7143),a=r(7710),i=r(6698),d=r(8901),c=r(1238);const l=Boolean({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_EMULATE);console.log({__emulate__:l});const u=l?"http://127.0.0.1:5001/maximprosv-server-ts/us-central1/functionsApp":"http://localhost:3005",p="/api/v1";var h=r(5103),y=r(8309);const g=(0,h.xP)({reducerPath:"api",baseQuery:(0,y.cw)({baseUrl:"".concat(u).concat(p),prepareHeaders:(e,t)=>{let{extra:r,endpoint:o,getState:n}=t;return e.set("Content-Type","application/json;charset=UTF-8"),e.set("Authorization","anonymous"),e.set("X-Request-ID",(0,c.A)()),e}}),endpoints:e=>({})}),m=(0,a.Z0)({name:"counter",initialState:0,reducers:{incrementAction:e=>e+1,decrementAction:e=>e-1}}),f=m.reducer,{incrementAction:v,decrementAction:U}=m.actions,A=(0,a.Z0)({name:"todos",initialState:{entities:[]},reducers:{addTodoAction(e,t){let{payload:r}=t;e.entities.push(r)},addTodoPreparedAction:{reducer:(e,t)=>{let{payload:r}=t;const{id:o,text:n}=r;e.entities.push({id:o,text:n,completed:!1})},prepare:e=>({payload:{text:e,id:"".concat(Math.random()*Date.now())}})},toggleTodoAction(e,t){let{payload:r}=t;const o=e.entities.find((e=>e.id===r));o&&(o.completed=!o.completed)}}}),{addTodoPreparedAction:b,toggleTodoAction:x,addTodoAction:C}=A.actions,P=A.reducer,S=(0,a.Z0)({name:"visibilityFilter",initialState:"SHOW_ALL",reducers:{setVisibilityFilterAction:(e,t)=>{let{payload:r}=t;return r}}}),{setVisibilityFilterAction:j}=S.actions,k=S.reducer;let L={org:"rails",repo:"rails",page:1,displayType:function(e){return e.Issues="issues",e.Comments="comments",e}({}).Issues,issueId:null};const T=(0,a.Z0)({name:"issuesDisplay",initialState:L,reducers:{displayRepo(e,t){let{payload:r}=t;const{org:o,repo:n}=r;e.org=o,e.repo=n},setCurrentPage(e,t){e.page=t.payload},setCurrentDisplayType(e,t){let{payload:r}=t;const{displayType:o,issueId:n=null}=r;e.displayType=o,e.issueId=n}}}),{displayRepo:D,setCurrentPage:E,setCurrentDisplayType:w}=T.actions,F=T.reducer;var _=r(2215),I=r(192);const R=(0,a.zD)("posts/fetchAll",(async(e,t)=>{try{const{data:e}=await _.A.get("https://jsonplaceholder.typicode.com/posts");return e}catch(r){return t.rejectWithValue(r)}})),M=(0,a.Z0)({name:"posts",initialState:{loading:!1,entities:[]},reducers:{fetchPostsStart(e){e.loading=!0},fetchPostsSuccess(e,t){let{payload:r}=t;e.entities=r,e.loading=!1},fetchPostsError(e,t){let{payload:r}=t;e.error=r,e.loading=!1}}}),{fetchPostsSuccess:O,fetchPostsError:N,fetchPostsStart:q}=M.actions,Q=M.reducer,z=e=>e.posts,W=()=>(0,I.Mz)([z,(e,t)=>t],((e,t)=>{var r;return null===(r=e.entities)||void 0===r?void 0:r.filter((e=>e.title.includes(t)))})),Z=(0,I.Mz)([z,(e,t)=>t],((e,t)=>{var r;return null===(r=e.entities)||void 0===r?void 0:r.filter((e=>e.title.includes(t)))}));var V=r(45);const B=["id"],K=(0,a.pU)({sortComparer:(e,t)=>e.title.localeCompare(t.title)}),H=(0,a.zD)("books/fetchAll",(async(e,t)=>{try{return await Promise.resolve([{id:"1",title:"title1"},{id:"2",title:"title2"},{id:"3",title:"title3"}])}catch(r){return t.rejectWithValue(r)}})),X=(0,a.zD)("books/updateOne",(async(e,t)=>await Promise.resolve(e))),Y=K.getInitialState({loading:!1}),J=(0,a.Z0)({name:"books",initialState:Y,reducers:{removeBookAction:K.removeOne,addBookAction:K.addOne,updateBookAction:K.updateOne},extraReducers:e=>{e.addCase(H.pending,((e,t)=>{e.loading=!0})),e.addCase(H.fulfilled,((e,t)=>{let{payload:r}=t;K.upsertMany(e,r),e.loading=!1})),e.addCase(X.fulfilled,((e,t)=>{let{payload:r}=t;const{id:o}=r,n=(0,V.A)(r,B);K.updateOne(e,{id:o,changes:n})}))}}),G=J.reducer,{removeBookAction:$,addBookAction:ee,updateBookAction:te}=J.actions,{selectById:re,selectIds:oe,selectEntities:ne,selectAll:se,selectTotal:ae}=K.getSelectors((e=>e.books)),ie="".concat(u).concat(p,"/users"),de=(0,a.zD)("thunkUser/fetchAll",(async(e,t)=>{try{const e=await fetch(ie);return await e.json()}catch(r){return t.rejectWithValue(r)}})),ce=(0,a.zD)("thunkUser/add",(async(e,t)=>{try{const t=await fetch(ie,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)});return await t.json()}catch(r){return t.rejectWithValue(r)}})),le=(0,a.zD)("thunkUser/update",(async(e,t)=>{try{const t=await fetch(ie,{method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)});return await t.json()}catch(r){return t.rejectWithValue(r)}})),ue=(0,a.zD)("thunkUser/delete",(async(e,t)=>{try{const t=await fetch("".concat(ie,"/").concat(e.id),{method:"DELETE",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)});return await t.json()}catch(r){return t.rejectWithValue(r)}}));function pe(e){return e.type.endsWith("/pending")}function he(e){return e.type.endsWith("/fulfilled")}const ye=["id"],ge=(0,a.pU)(),me=ge.getInitialState({loading:!1}),fe=(0,a.Z0)({name:"thunkUser",initialState:me,reducers:{},extraReducers:e=>{e.addCase(de.fulfilled,ge.upsertMany),e.addCase(ce.fulfilled,ge.addOne),e.addCase(le.fulfilled,((e,t)=>{let{payload:r}=t;const{id:o}=r,n=(0,V.A)(r,ye);ge.updateOne(e,{id:o,changes:n})})),e.addCase(ue.fulfilled,((e,t)=>{let{payload:r}=t;ge.removeOne(e,r.id)})),e.addMatcher(pe,(e=>{e.loading=!0})),e.addMatcher(he,(e=>{e.loading=!1}))}}).reducer,{selectAll:ve}=ge.getSelectors((e=>e.thunkUser));var Ue=r(9379);let Ae=function(e){return e.Product1="product1",e.Product2="product2",e}({});const be=(0,a.pU)(),xe=be.getInitialState();console.log({product1InnerPropAdapterInitialState:xe});const Ce=(0,a.Z0)({name:"product/feature",initialState:null,reducers:{setProductFeatureNameAction(e,t){e.name=t.payload}}}),Pe=Ce.reducer,{setProductFeatureNameAction:Se}=Ce.actions,je=(0,a.Z0)({name:"product/product1",initialState:{},reducers:{setProduct1innerPropAction(e,t){be.setMany(e.product1InnerProp,t.payload)},setProduct1PropAction(e,t){e.prop=t.payload}},extraReducers:e=>{e.addDefaultCase(((e,t)=>{Pe(e,t)}))}}),ke=je.reducer,{setProduct1innerPropAction:Le,setProduct1PropAction:Te}=je.actions,De=(0,a.pU)({}),Ee=(De.getInitialState(),(0,a.Z0)({name:"product/product2",initialState:null,reducers:{setProduct2innerPropAction(e,t){De.setMany(e.product2InnerProp,t.payload)}},extraReducers:e=>{e.addDefaultCase(((e,t)=>{Pe(e,t)}))}})),we=Ee.reducer,{setProduct2innerPropAction:Fe}=Ee.actions,_e=(0,a.VP)("product/setProductAction"),Ie=((0,a.VP)("product/resetProductAction"),{type:Ae.Product1,product1InnerProp:xe}),Re=(0,a.Z0)({name:"product",initialState:Ie,reducers:{setProductTypeAction(e,t){e.type=t.payload}},extraReducers(e){e.addCase(_e,((e,t)=>(0,Ue.A)((0,Ue.A)({},e),t.payload))),e.addDefaultCase(((e,t)=>((e,t)=>{switch(null===e||void 0===e?void 0:e.type){case Ae.Product1:return ke(e,t);case Ae.Product2:return we(e,t)}})(e,t)))}}),{setProductTypeAction:Me}=Re.actions,Oe=Re.reducer;let Ne=function(e){return e.XRequestId="x-request-id",e}({}),qe=function(e){return e.ConditionError="ConditionError",e}({});const Qe=[],ze=e=>e=>t=>{if((0,a.TK)(t)){var r,o,n,s,i,d,c;let e=null===(r=t.meta)||void 0===r||null===(o=r.baseQueryMeta)||void 0===o||null===(n=o.request)||void 0===n?void 0:n.headers,a=null===(s=t.meta)||void 0===s||null===(i=s.baseQueryMeta)||void 0===i||null===(d=i.response)||void 0===d?void 0:d.headers;if(e)for(let t of e)console.log("headersReq",t);if(a)for(let t of a)console.log("headersRes",t);t.error.name===qe.ConditionError||Qe.includes(null===(c=t.meta.arg.arg)||void 0===c?void 0:c.endpointName)||function(e){var t,r,o,n;const s=e.meta;if(!s)return console.error("logRequestError Action doesn't contain 'meta'",e);const{request:a,response:i}=s.baseQueryMeta;if(!a&&!i)return console.error("Request/response error: ".concat(s.baseQueryMeta));const{method:d,url:c}=null!==a&&void 0!==a?a:{},{status:l,statusText:u}=null!==i&&void 0!==i?i:{},p=(null===(t=e.meta)||void 0===t||null===(r=t.baseQueryMeta)||void 0===r||null===(o=r.request)||void 0===o?void 0:o.headers)||[],h=null===(n=[...p].find((e=>{let[t]=e;return t===Ne.XRequestId})))||void 0===n?void 0:n[1];console.group("ERROR: ".concat(d," ").concat(c)),console.log("STATUS: ".concat(l)),console.log("STATUS-TEXT: ".concat(u)),console.log("X-REQUEST-ID: ".concat(h)),s.arg&&console.log("RTK QUERY: ".concat(s.arg.type," ").concat(s.arg.endpointName));e.payload&&(console.groupCollapsed("PAYLOAD"),console.log(JSON.stringify(e.payload,null,4)),console.groupEnd());console.groupEnd()}(t)}return e(t)};const We={key:"root",version:1,storage:d.A,whitelist:["todos"]},Ze=(0,i.rL)(We,G),Ve=(0,s.HY)({counter:f,todos:P,visibilityFilter:k,books:Ze,issuesDisplay:F,posts:Q,thunkUser:fe,product:Oe,[g.reducerPath]:g.reducer}),Be=(0,a.U1)({reducer:Ve,preloadedState:{},middleware:e=>e({thunk:{extraArgument:{fetchPolicy:"cache-first"}},immutableCheck:!1,serializableCheck:{ignoredActions:[i.ZM,i.r2,i.Hz,i.DY,i.Cq,i.eY]}}).concat(g.middleware,ze),devTools:!1});(0,y.$k)(Be.dispatch);const Ke=Be,He=()=>(0,n.wA)(),Xe=n.d4,Ye=(0,i.GM)(Be);var Je=r(2601);function Ge(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];const a=(0,o.useMemo)(e,[e]);return(0,n.d4)((e=>a(e,...r)))}var $e=r(579);const et=()=>{const[e,t]=(0,o.useState)(""),r=He(),{loading:s,entities:a,error:i}=(0,n.d4)(z);return(0,o.useEffect)((()=>{(async()=>{await r((async(e,t)=>{e(q());try{const{data:t}=await _.A.get("https://jsonplaceholder.typicode.com/posts");return e(O(t)),t}catch(i){throw i instanceof Error&&e(N(i)),console.error("error ",i),i}})),await r(R())})()}),[r]),i?(0,$e.jsx)($e.Fragment,{children:i}):s?(0,$e.jsx)(Je.A,{}):(0,$e.jsxs)("ul",{children:[(0,$e.jsx)("button",{onClick:()=>t((e=>e+"a")),children:"Click"}),(0,$e.jsx)(tt,{prop:e}),(0,$e.jsx)(rt,{}),a.slice(0,5).map((e=>{let{id:t,title:r,body:o}=e;return(0,$e.jsxs)("li",{style:{margin:10},children:[(0,$e.jsx)("h5",{children:r}),(0,$e.jsx)("p",{children:o})]},t)}))]})};function tt(e){let{prop:t}=e;const r=Ge(W,t),n=Xe((e=>Z(e,t)));return(0,$e.jsxs)($e.Fragment,{children:[n.map((e=>(0,$e.jsx)(o.Fragment,{children:e.title},e.id))),r.map((e=>(0,$e.jsx)(o.Fragment,{children:e.title},e.id)))]})}function rt(e){let{prop:t="a"}=e;const r=Ge(W,t),n=Xe((e=>Z(e,t)));return(0,$e.jsxs)($e.Fragment,{children:[n.map((e=>(0,$e.jsx)(o.Fragment,{children:e.title},e.id))),r.map((e=>(0,$e.jsx)(o.Fragment,{children:e.title},e.id)))]})}const ot=(0,o.memo)(et),nt="user-list_block__yGNeD",st="user-list_list__cbBd9",at="user-list_listItem__5zIaF",it="user-list_button__paQSC",dt="user_user__D2osa",ct=(0,o.memo)((function(e){let{model:t,deleteUser:r,updateUser:n}=e;const{name:s}=t,[a,i]=(0,o.useState)(),[d,c]=(0,o.useState)(s),[l,u]=(0,o.useState)(!1);return a?(0,$e.jsxs)("div",{className:dt,children:[(0,$e.jsx)("input",{type:"text",value:d,onChange:e=>{const t=e.target.value.trim();t&&c(t)}}),(0,$e.jsx)("button",{type:"button",onClick:()=>{d&&(null===n||void 0===n||n((0,Ue.A)((0,Ue.A)({},t),{},{name:d})))},children:"Update"}),(0,$e.jsx)("button",{onClick:()=>{i(!1)},type:"button",children:"Cancel"})]}):(0,$e.jsxs)("div",{className:dt,onClick:()=>u((e=>!e)),children:[(0,$e.jsx)("div",{children:s}),l&&(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsx)("button",{onClick:()=>{i(!0)},type:"button",children:"Edit"}),(0,$e.jsx)("button",{onClick:()=>null===r||void 0===r?void 0:r(t),type:"button",children:"Delete"})]})]})}));var lt=r(3536);const ut=g.injectEndpoints({endpoints:e=>({fetchUserList:e.query({query:()=>({url:"users"})}),fetchUser:e.query({async queryFn(e,t,r,o){let{userId:n}=e,{dispatch:s,getState:a}=t;const i=await o({url:"users/".concat(n),method:"GET"});if(i.error)return i;return{data:i.data}}}),addUser:e.mutation({query:e=>{let{user:t}=e;return{url:"users",method:"POST",body:t}},async onQueryStarted(e,t){let{user:r}=e,{dispatch:o,queryFulfilled:n}=t;try{const{data:e}=await n;o(ut.util.updateQueryData("fetchUserList",void 0,(t=>{t.push(e)})))}catch(s){console.error("addUser onQueryStarted error")}}}),addUserDebounced:e.mutation({async queryFn(e,t,r,o){var n;let{user:s,cancelDebounce:a}=e,{dispatch:i,getState:d}=t;return{data:null!==(n=await pt(s,i,o))&&void 0!==n?n:null}}}),updateUser:e.mutation({query:e=>{let{user:t}=e;return{url:"users",method:"PUT",body:t}},async onQueryStarted(e,t){let{user:r}=e,{dispatch:o,queryFulfilled:n}=t;const s=o(ut.util.updateQueryData("fetchUserList",void 0,(e=>{const t=e.findIndex((e=>e.id===r.id));e[t]=r})));try{await n}catch(a){s.undo()}}}),deleteUser:e.mutation({async queryFn(e,t,r,o){let{dispatch:n,getState:s}=t;const a=await o({url:"users/".concat(e.id),method:"DELETE"});if(a.error)return a;const i=a.data;return n(ut.util.updateQueryData("fetchUserList",void 0,(t=>t.filter((t=>t.id!==e.id))))),{data:i}}})}),overrideExisting:!0}),pt=(0,lt.debounce)((async(e,t,r)=>{const o=await r({url:"users",method:"POST",body:e});if(o.error)throw o.error;const n=o.data;return t(ut.util.updateQueryData("fetchUserList",void 0,(e=>{e.push(n)}))),n}),1e3,{leading:!0}),ht=ut.endpoints.fetchUserList.select(),yt=e=>ht(e).isLoading;const gt=()=>{const{ref:e,users:t,usersLoading:r,usersLoading2:s,addUserLoading:a,addUserDebouncedLoading:i,deleteUserLoading:d,updateUserLoading:c,onAddUser:l,onAddUserDebounced:u,onUpdateUser:p,onDeleteUser:h,onFetchUserLazy:y,onPollingStart:g,onPollingEnd:m,customInitiateFetchUserList:f}=function(){var e,t;const r=He(),[s,a]=(0,o.useState)(0),{data:i=[],isLoading:d}=ut.useFetchUserListQuery(void 0,{refetchOnReconnect:!0}),c=(0,n.d4)(yt),{data:l,isLoading:u,isFetching:p}=ut.useFetchUserQuery({userId:null!==(e=null===(t=i[0])||void 0===t?void 0:t.id)&&void 0!==e?e:null},{pollingInterval:s}),[h,y]=ut.useLazyFetchUserQuery(),g=(0,o.useRef)(),[m,{isLoading:f}]=ut.useAddUserMutation({fixedCacheKey:"userMutation"}),[v,{isLoading:U}]=ut.useAddUserDebouncedMutation({fixedCacheKey:"userMutation"}),[A,{isLoading:b}]=ut.useDeleteUserMutation({fixedCacheKey:"userMutation"}),[x,{isLoading:C}]=ut.useUpdateUserMutation({fixedCacheKey:"userMutation"}),P=(0,o.useRef)(null),S=(0,o.useCallback)((()=>{var e;const t=null===(e=P.current)||void 0===e?void 0:e.value.trim();t&&m({user:{name:t}})}),[m]),j=(0,o.useCallback)((()=>{var e;const t=null===(e=P.current)||void 0===e?void 0:e.value.trim();t&&v({user:{name:t}})}),[v]),k=(0,o.useCallback)((async()=>{var e,t,r;null===(e=g.current)||void 0===e||e.abort(),g.current=h({userId:null!==(t=null===(r=i[0])||void 0===r?void 0:r.id)&&void 0!==t?t:null},!0);const o=await g.current;console.log({lazyUser:o})}),[h,i]),L=(0,o.useCallback)((async e=>{const t=await x({user:e}).unwrap().catch((e=>console.log(e)));console.log({updatedUser:t})}),[x]),T=(0,o.useCallback)((async e=>{let t;t=await A(e),"error"in t&&console.error("delete use error"),console.log(t)}),[A]);(0,o.useEffect)((()=>{console.log({user:l,userLoading:u,userFetching:p})}),[l,u,p]),(0,o.useEffect)((()=>{console.log({addUserLoading:f,deleteUserLoading:b,updateUserLoading:C,addUserDebouncedLoading:U})}),[f,b,C,U]),(0,o.useEffect)((()=>{console.log("in useEffect ",{lazyUser:y})}),[y]);const D=(0,o.useCallback)((async()=>a(1e3)),[]),E=(0,o.useCallback)((async()=>a(0)),[]),w=(0,o.useCallback)((async()=>{const e=await r(ut.endpoints.fetchUserList.initiate());console.log({res:e})}),[r]);return{ref:P,users:i,usersLoading:d,usersLoading2:c,addUserLoading:f,deleteUserLoading:b,updateUserLoading:C,addUserDebouncedLoading:U,onAddUser:S,onAddUserDebounced:j,onDeleteUser:T,onUpdateUser:L,onFetchUserLazy:k,onPollingStart:D,onPollingEnd:E,customInitiateFetchUserList:w}}();return(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsxs)("div",{children:[(0,$e.jsx)("button",{type:"button",onClick:f,children:"custom trigger initiate"}),(0,$e.jsx)("button",{type:"button",className:it,onClick:g,children:"Start Polling"}),(0,$e.jsx)("button",{type:"button",className:it,onClick:m,children:"End Polling"}),(0,$e.jsx)("button",{type:"button",className:it,onClick:y,children:"Fetch Lazy User)"})]}),(0,$e.jsxs)("div",{className:nt,children:[(0,$e.jsx)("input",{type:"text",ref:e,placeholder:"User Name"}),(0,$e.jsx)("button",{type:"button",className:it,onClick:l,children:"Add user"}),(0,$e.jsx)("button",{type:"button",className:it,onClick:u,children:"Add Debounced user"})]}),(0,$e.jsx)("div",{className:nt,children:s||a||d||c||i?(0,$e.jsx)($e.Fragment,{children:"Loading..."}):(0,$e.jsx)("ul",{className:st,children:t.map((e=>(0,$e.jsx)("li",{className:at,children:(0,$e.jsx)(ct,{model:e,updateUser:p,deleteUser:h})},e.id)))})})]})},mt=(0,o.memo)(gt);var ft=r(4730);const vt=()=>(0,$e.jsx)(n.Kq,{store:Ke,children:(0,$e.jsxs)(ft.Q,{loading:null,persistor:Ye,children:[(0,$e.jsx)(mt,{}),(0,$e.jsx)(ot,{})]})}),Ut=(0,o.memo)(vt)}}]);
//# sourceMappingURL=692.7d38b0fe.chunk.js.map