"use strict";(self.webpackChunkreact_main=self.webpackChunkreact_main||[]).push([[692],{1692:(e,t,r)=>{r.r(t),r.d(t,{default:()=>gt});var n=r(5043),o=r(2166),a=r(2621),s=r(7255),i=r(6698),c=r(8901),d=r(7048),l=r(7731),u=r(1238);const p=Boolean({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_EMULATE);console.log({__emulate__:p});const y=p?"http://127.0.0.1:5001/maximprosv-server-ts/us-central1/functionsApp":"http://localhost:3005",h="/api/v1",g=(0,l.createApi)({reducerPath:"api",baseQuery:(0,l.fetchBaseQuery)({baseUrl:"".concat(y).concat(h),prepareHeaders:(e,t)=>{let{extra:r,endpoint:n,getState:o}=t;return e.set("Content-Type","application/json;charset=UTF-8"),e.set("Authorization","anonymous"),e.set("X-Request-ID",(0,u.A)()),e}}),tagTypes:["User"],endpoints:e=>({})}),m=(0,a.createSlice)({name:"counter",initialState:0,reducers:{incrementAction:e=>e+1,decrementAction:e=>e-1}}),f=m.reducer,{incrementAction:v,decrementAction:A}=m.actions,S=(0,a.createSlice)({name:"todos",initialState:{entities:[]},reducers:{addTodoAction(e,t){let{payload:r}=t;e.entities.push(r)},addTodoPreparedAction:{reducer:(e,t)=>{let{payload:r}=t;const{id:n,text:o}=r;e.entities.push({id:n,text:o,completed:!1})},prepare:e=>({payload:{text:e,id:"".concat(Math.random()*Date.now())}})},toggleTodoAction(e,t){let{payload:r}=t;const n=e.entities.find((e=>e.id===r));n&&(n.completed=!n.completed)}}}),{addTodoPreparedAction:U,toggleTodoAction:b,addTodoAction:x}=S.actions,C=S.reducer,j=(0,a.createSlice)({name:"visibilityFilter",initialState:"SHOW_ALL",reducers:{setVisibilityFilterAction:(e,t)=>{let{payload:r}=t;return r}}}),{setVisibilityFilterAction:P}=j.actions,T=j.reducer;let k={org:"rails",repo:"rails",page:1,displayType:function(e){return e.Issues="issues",e.Comments="comments",e}({}).Issues,issueId:null};const E=(0,a.createSlice)({name:"issuesDisplay",initialState:k,reducers:{displayRepo(e,t){let{payload:r}=t;const{org:n,repo:o}=r;e.org=n,e.repo=o},setCurrentPage(e,t){e.page=t.payload},setCurrentDisplayType(e,t){let{payload:r}=t;const{displayType:n,issueId:o=null}=r;e.displayType=n,e.issueId=o}}}),{displayRepo:L,setCurrentPage:D,setCurrentDisplayType:w}=E.actions,F=E.reducer;var _=r(2215),R=r(2222);const I=(0,a.createAsyncThunk)("posts/fetchAll",(async(e,t)=>{try{const{data:e}=await _.A.get("https://jsonplaceholder.typicode.com/posts");return e}catch(r){return t.rejectWithValue(r)}})),M=(0,a.createSlice)({name:"posts",initialState:{loading:!1,entities:[]},reducers:{fetchPostsStart(e){e.loading=!0},fetchPostsSuccess(e,t){let{payload:r}=t;e.entities=r,e.loading=!1},fetchPostsError(e,t){let{payload:r}=t;e.error=r,e.loading=!1}},extraReducers:{[I.pending.type]:(e,t)=>{let{payload:r}=t;e.error=r,e.loading=!0},[I.fulfilled.type]:(e,t)=>{let{payload:r}=t;e.entities=r,e.loading=!1},[I.rejected.type]:(e,t)=>{let{payload:r}=t;e.error=r,e.loading=!1}}}),{fetchPostsSuccess:O,fetchPostsError:N,fetchPostsStart:q}=M.actions,Q=M.reducer,z=e=>e.posts,B=()=>(0,R.Mz)([z,(e,t)=>t],((e,t)=>{var r;return null===(r=e.entities)||void 0===r?void 0:r.filter((e=>e.title.includes(t)))})),W=(0,R.Mz)([z,(e,t)=>t],((e,t)=>{var r;return null===(r=e.entities)||void 0===r?void 0:r.filter((e=>e.title.includes(t)))})),V=(0,a.createEntityAdapter)({sortComparer:(e,t)=>e.title.localeCompare(t.title)}),K=(0,a.createAsyncThunk)("books/fetchAll",(async(e,t)=>{try{return await Promise.resolve([{id:"1",title:"title1"},{id:"2",title:"title2"},{id:"3",title:"title3"}])}catch(r){return t.rejectWithValue(r)}})),H=(0,a.createAsyncThunk)("books/updateOne",(async(e,t)=>await Promise.resolve(e))),X=V.getInitialState({loading:!1}),Y=(0,a.createSlice)({name:"books",initialState:X,reducers:{removeBookAction:V.removeOne,addBookAction:V.addOne,updateBookAction:V.updateOne},extraReducers:e=>{e.addCase(K.pending,((e,t)=>{e.loading=!0})),e.addCase(K.fulfilled,((e,t)=>{let{payload:r}=t;V.upsertMany(e,r),e.loading=!1})),e.addCase(H.fulfilled,((e,t)=>{let{payload:r}=t;const{id:n,...o}=r;V.updateOne(e,{id:n,changes:o})}))}}),J=Y.reducer,{removeBookAction:G,addBookAction:Z,updateBookAction:$}=Y.actions,{selectById:ee,selectIds:te,selectEntities:re,selectAll:ne,selectTotal:oe}=V.getSelectors((e=>e.books)),ae="".concat(y).concat(h,"/users"),se=(0,a.createAsyncThunk)("thunkUser/fetchAll",(async(e,t)=>{try{const e=await fetch(ae);return await e.json()}catch(r){return t.rejectWithValue(r)}})),ie=(0,a.createAsyncThunk)("thunkUser/add",(async(e,t)=>{try{const t=await fetch(ae,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)});return await t.json()}catch(r){return t.rejectWithValue(r)}})),ce=(0,a.createAsyncThunk)("thunkUser/update",(async(e,t)=>{try{const t=await fetch(ae,{method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)});return await t.json()}catch(r){return t.rejectWithValue(r)}})),de=(0,a.createAsyncThunk)("thunkUser/delete",(async(e,t)=>{try{const t=await fetch("".concat(ae,"/").concat(e.id),{method:"DELETE",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)});return await t.json()}catch(r){return t.rejectWithValue(r)}}));function le(e){return e.type.endsWith("/pending")}function ue(e){return e.type.endsWith("/fulfilled")}const pe=(0,a.createEntityAdapter)(),ye=pe.getInitialState({loading:!1}),he=(0,a.createSlice)({name:"thunkUser",initialState:ye,reducers:{},extraReducers:e=>{e.addCase(se.fulfilled,pe.upsertMany),e.addCase(ie.fulfilled,pe.addOne),e.addCase(ce.fulfilled,((e,t)=>{let{payload:r}=t;const{id:n,...o}=r;pe.updateOne(e,{id:n,changes:o})})),e.addCase(de.fulfilled,((e,t)=>{let{payload:r}=t;pe.removeOne(e,r.id)})),e.addMatcher(le,(e=>{e.loading=!0})),e.addMatcher(ue,(e=>{e.loading=!1}))}}).reducer,{selectAll:ge}=pe.getSelectors((e=>e.thunkUser));let me=function(e){return e.Product1="product1",e.Product2="product2",e}({});const fe=(0,a.createEntityAdapter)(),ve=fe.getInitialState();console.log({product1InnerPropAdapterInitialState:ve});const Ae=(0,a.createSlice)({name:"product/feature",initialState:null,reducers:{setProductFeatureNameAction(e,t){e.name=t.payload}}}),Se=Ae.reducer,{setProductFeatureNameAction:Ue}=Ae.actions,be=(0,a.createSlice)({name:"product/product1",initialState:{},reducers:{setProduct1innerPropAction(e,t){fe.setMany(e.product1InnerProp,t.payload)},setProduct1PropAction(e,t){e.prop=t.payload}},extraReducers:e=>{e.addDefaultCase(((e,t)=>{Se(e,t)}))}}),xe=be.reducer,{setProduct1innerPropAction:Ce,setProduct1PropAction:je}=be.actions,Pe=(0,a.createEntityAdapter)({}),Te=(Pe.getInitialState(),(0,a.createSlice)({name:"product/product2",initialState:null,reducers:{setProduct2innerPropAction(e,t){Pe.setMany(e.product2InnerProp,t.payload)}},extraReducers:e=>{e.addDefaultCase(((e,t)=>{Se(e,t)}))}})),ke=Te.reducer,{setProduct2innerPropAction:Ee}=Te.actions,Le=(0,a.createAction)("product/setProductAction"),De=((0,a.createAction)("product/resetProductAction"),{type:me.Product1,product1InnerProp:ve}),we=(0,a.createSlice)({name:"product",initialState:De,reducers:{setProductTypeAction(e,t){e.type=t.payload}},extraReducers(e){e.addCase(Le,((e,t)=>({...e,...t.payload}))),e.addDefaultCase(((e,t)=>((e,t)=>{switch(null===e||void 0===e?void 0:e.type){case me.Product1:return xe(e,t);case me.Product2:return ke(e,t)}})(e,t)))}}),{setProductTypeAction:Fe}=we.actions,_e=we.reducer;let Re=function(e){return e.XRequestId="x-request-id",e}({}),Ie=function(e){return e.ConditionError="ConditionError",e}({});const Me=[],Oe=e=>e=>t=>{var r,n,o,s,i,c;let d=null===(r=t.meta)||void 0===r||null===(n=r.baseQueryMeta)||void 0===n||null===(o=n.request)||void 0===o?void 0:o.headers,l=null===(s=t.meta)||void 0===s||null===(i=s.baseQueryMeta)||void 0===i||null===(c=i.response)||void 0===c?void 0:c.headers;if((0,a.isRejected)(t)){var u;if(d)for(let e of d)console.log("headersReq",e);if(l)for(let e of l)console.log("headersRes",e);t.error.name===Ie.ConditionError||Me.includes(null===(u=t.meta.arg)||void 0===u?void 0:u.endpointName)||function(e){var t,r,n,o;const a=e.meta;if(!a)return console.error("logRequestError Action doesn't contain 'meta'",e);const{request:s,response:i}=a.baseQueryMeta;if(!s&&!i)return console.error("Request/response error: ".concat(a.baseQueryMeta));const{method:c,url:d}=null!==s&&void 0!==s?s:{},{status:l,statusText:u}=null!==i&&void 0!==i?i:{},p=(null===(t=e.meta)||void 0===t||null===(r=t.baseQueryMeta)||void 0===r||null===(n=r.request)||void 0===n?void 0:n.headers)||[],y=null===(o=[...p].find((e=>{let[t]=e;return t===Re.XRequestId})))||void 0===o?void 0:o[1];console.group("ERROR: ".concat(c," ").concat(d)),console.log("STATUS: ".concat(l)),console.log("STATUS-TEXT: ".concat(u)),console.log("X-REQUEST-ID: ".concat(y)),a.arg&&console.log("RTK QUERY: ".concat(a.arg.type," ").concat(a.arg.endpointName));e.payload&&(console.groupCollapsed("PAYLOAD"),console.log(JSON.stringify(e.payload,null,4)),console.groupEnd());console.groupEnd()}(t)}return e(t)};var Ne=r(4657);const qe={key:"root",version:1,storage:c.A,whitelist:["todos"]},Qe=(0,d.HY)({counter:f,todos:C,visibilityFilter:T,issuesDisplay:F,posts:Q,books:J,thunkUser:he,product:_e,[g.reducerPath]:g.reducer}),ze=(0,i.rL)(qe,Qe),Be=(0,a.configureStore)({reducer:ze,preloadedState:{},middleware:e=>e({thunk:{extraArgument:{fetchPolicy:"cache-first"}},immutableCheck:!1,serializableCheck:{ignoredActions:[i.ZM,i.r2,i.Hz,i.DY,i.Cq,i.eY]}}).concat(g.middleware,Oe),devTools:!1,enhancers:[s.reduxBatch]}),We=(0,i.GM)(Be);(0,Ne.setupListeners)(Be.dispatch);const Ve=Be,Ke=o.useSelector;var He=r(4730),Xe=r(2601);function Ye(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];const s=(0,n.useMemo)(e,[e]);return(0,o.useSelector)((e=>s(e,...r)))}var Je=r(579);const Ge=()=>{const[e,t]=(0,n.useState)(""),r=(0,o.useDispatch)(),{loading:a,entities:s,error:i}=(0,o.useSelector)(z);return(0,n.useEffect)((()=>{(async()=>{await r((async(e,t)=>{e(q());try{const{data:t}=await _.A.get("https://jsonplaceholder.typicode.com/posts");return e(O(t)),t}catch(i){throw i instanceof Error&&e(N(i)),console.error("error ",i),i}})),await r(I())})()}),[r]),i?(0,Je.jsx)(Je.Fragment,{children:i}):a?(0,Je.jsx)(Xe.A,{}):(0,Je.jsxs)("ul",{children:[(0,Je.jsx)("button",{onClick:()=>t((e=>e+"a")),children:"Click"}),(0,Je.jsx)(Ze,{prop:e}),(0,Je.jsx)($e,{}),s.slice(0,5).map((e=>{let{id:t,title:r,body:n}=e;return(0,Je.jsxs)("li",{style:{margin:10},children:[(0,Je.jsx)("h5",{children:r}),(0,Je.jsx)("p",{children:n})]},t)}))]})};function Ze(e){let{prop:t}=e;const r=Ye(B,t),o=Ke((e=>W(e,t)));return(0,Je.jsxs)(Je.Fragment,{children:[o.map((e=>(0,Je.jsx)(n.Fragment,{children:e.title},e.id))),r.map((e=>(0,Je.jsx)(n.Fragment,{children:e.title},e.id)))]})}function $e(e){let{prop:t="a"}=e;const r=Ye(B,t),o=Ke((e=>W(e,t)));return(0,Je.jsxs)(Je.Fragment,{children:[o.map((e=>(0,Je.jsx)(n.Fragment,{children:e.title},e.id))),r.map((e=>(0,Je.jsx)(n.Fragment,{children:e.title},e.id)))]})}const et=(0,n.memo)(Ge),tt="user-list_block__yGNeD",rt="user-list_list__cbBd9",nt="user-list_listItem__5zIaF",ot="user-list_button__paQSC",at="user_user__D2osa",st=(0,n.memo)((function(e){let{model:t,deleteUser:r,updateUser:o}=e;const{name:a}=t,[s,i]=(0,n.useState)(),[c,d]=(0,n.useState)(a),[l,u]=(0,n.useState)(!1);return s?(0,Je.jsxs)("div",{className:at,children:[(0,Je.jsx)("input",{type:"text",value:c,onChange:e=>{const t=e.target.value.trim();t&&d(t)}}),(0,Je.jsx)("button",{type:"button",onClick:()=>{c&&(null===o||void 0===o||o({...t,name:c}))},children:"Update"}),(0,Je.jsx)("button",{onClick:()=>{i(!1)},type:"button",children:"Cancel"})]}):(0,Je.jsxs)("div",{className:at,onClick:()=>u((e=>!e)),children:[(0,Je.jsx)("div",{children:a}),l&&(0,Je.jsxs)(Je.Fragment,{children:[(0,Je.jsx)("button",{onClick:()=>{i(!0)},type:"button",children:"Edit"}),(0,Je.jsx)("button",{onClick:()=>null===r||void 0===r?void 0:r(t),type:"button",children:"Delete"})]})]})}));var it=r(3536);const ct=g.injectEndpoints({endpoints:e=>({fetchUserList:e.query({query:()=>({url:"users"})}),fetchUser:e.query({async queryFn(e,t,r,n){let{userId:o}=e,{dispatch:a,getState:s}=t;const i=await n({url:"users/".concat(o),method:"GET"});if(i.error)return i;return{data:i.data}}}),addUser:e.mutation({query:e=>{let{user:t}=e;return{url:"users",method:"POST",body:t}},async onQueryStarted(e,t){let{user:r}=e,{dispatch:n,queryFulfilled:o}=t;try{const{data:e}=await o;n(ct.util.updateQueryData("fetchUserList",void 0,(t=>{t.push(e)})))}catch{console.error("addUser onQueryStarted error")}}}),addUserDebounced:e.mutation({async queryFn(e,t,r,n){var o;let{user:a,cancelDebounce:s}=e,{dispatch:i,getState:c}=t;return{data:null!==(o=await dt(a,i,n))&&void 0!==o?o:null}}}),updateUser:e.mutation({query:e=>{let{user:t}=e;return{url:"users",method:"PUT",body:t}},async onQueryStarted(e,t){let{user:r}=e,{dispatch:n,queryFulfilled:o}=t;const a=n(ct.util.updateQueryData("fetchUserList",void 0,(e=>{const t=e.findIndex((e=>e.id===r.id));e[t]=r})));try{await o}catch{a.undo()}}}),deleteUser:e.mutation({async queryFn(e,t,r,n){let{dispatch:o,getState:a}=t;const s=await n({url:"users/".concat(e.id),method:"DELETE"});if(s.error)return s;const i=s.data;return o(ct.util.updateQueryData("fetchUserList",void 0,(t=>t.filter((t=>t.id!==e.id))))),{data:i}}})})}),dt=(0,it.debounce)((async(e,t,r)=>{const n=await r({url:"users",method:"POST",body:e});if(n.error)throw n.error;const o=n.data;return t(ct.util.updateQueryData("fetchUserList",void 0,(e=>{e.push(o)}))),o}),1e3,{leading:!0}),lt=ct.endpoints.fetchUserList.select(),ut=e=>lt(e).isLoading;const pt=()=>{const{ref:e,users:t,usersLoading:r,usersLoading2:a,addUserLoading:s,addUserDebouncedLoading:i,deleteUserLoading:c,updateUserLoading:d,onAddUser:l,onAddUserDebounced:u,onUpdateUser:p,onDeleteUser:y,onFetchUserLazy:h,onPollingStart:g,onPollingEnd:m}=function(){var e,t;const[r,a]=(0,n.useState)(0),{data:s=[],isLoading:i}=ct.useFetchUserListQuery(void 0,{refetchOnReconnect:!0}),c=(0,o.useSelector)(ut),{data:d,isLoading:l,isFetching:u}=ct.useFetchUserQuery({userId:null!==(e=null===(t=s[0])||void 0===t?void 0:t.id)&&void 0!==e?e:null},{pollingInterval:r}),[p,y]=ct.useLazyFetchUserQuery(),h=(0,n.useRef)(),[g,{isLoading:m}]=ct.useAddUserMutation({fixedCacheKey:"userMutation"}),[f,{isLoading:v}]=ct.useAddUserDebouncedMutation({fixedCacheKey:"userMutation"}),[A,{isLoading:S}]=ct.useDeleteUserMutation({fixedCacheKey:"userMutation"}),[U,{isLoading:b}]=ct.useUpdateUserMutation({fixedCacheKey:"userMutation"}),x=(0,n.useRef)(null),C=(0,n.useCallback)((()=>{var e;const t=null===(e=x.current)||void 0===e?void 0:e.value.trim();t&&g({user:{name:t}})}),[g]),j=(0,n.useCallback)((()=>{var e;const t=null===(e=x.current)||void 0===e?void 0:e.value.trim();t&&f({user:{name:t}})}),[f]),P=(0,n.useCallback)((async()=>{var e,t,r;null===(e=h.current)||void 0===e||e.abort(),h.current=p({userId:null!==(t=null===(r=s[0])||void 0===r?void 0:r.id)&&void 0!==t?t:null},!0);const n=await h.current;console.log({lazyUser:n})}),[p,s]),T=(0,n.useCallback)((async e=>{const t=await U({user:e}).unwrap().catch((e=>console.log(e)));console.log({updatedUser:t})}),[U]),k=(0,n.useCallback)((async e=>{let t;t=await A(e),"error"in t&&console.error("delete use error"),console.log(t)}),[A]);(0,n.useEffect)((()=>{console.log({user:d,userLoading:l,userFetching:u})}),[d,l,u]),(0,n.useEffect)((()=>{console.log({addUserLoading:m,deleteUserLoading:S,updateUserLoading:b,addUserDebouncedLoading:v})}),[m,S,b,v]),(0,n.useEffect)((()=>{console.log("in useEffect ",{lazyUser:y})}),[y]);const E=(0,n.useCallback)((async()=>a(1e3)),[]),L=(0,n.useCallback)((async()=>a(0)),[]);return{ref:x,users:s,usersLoading:i,usersLoading2:c,addUserLoading:m,deleteUserLoading:S,updateUserLoading:b,addUserDebouncedLoading:v,onAddUser:C,onAddUserDebounced:j,onDeleteUser:k,onUpdateUser:T,onFetchUserLazy:P,onPollingStart:E,onPollingEnd:L}}();return(0,Je.jsxs)(Je.Fragment,{children:[(0,Je.jsxs)("div",{children:[(0,Je.jsx)("button",{type:"button",className:ot,onClick:g,children:"Start Polling"}),(0,Je.jsx)("button",{type:"button",className:ot,onClick:m,children:"End Polling"}),(0,Je.jsx)("button",{type:"button",className:ot,onClick:h,children:"Fetch Lazy User)"})]}),(0,Je.jsxs)("div",{className:tt,children:[(0,Je.jsx)("input",{type:"text",ref:e,placeholder:"User Name"}),(0,Je.jsx)("button",{type:"button",className:ot,onClick:l,children:"Add user"}),(0,Je.jsx)("button",{type:"button",className:ot,onClick:u,children:"Add Debounced user"})]}),(0,Je.jsx)("div",{className:tt,children:a||s||c||d||i?(0,Je.jsx)(Je.Fragment,{children:"Loading..."}):(0,Je.jsx)("ul",{className:rt,children:t.map((e=>(0,Je.jsx)("li",{className:nt,children:(0,Je.jsx)(st,{model:e,updateUser:p,deleteUser:y})},e.id)))})})]})},yt=(0,n.memo)(pt),ht=()=>(0,Je.jsx)(o.Provider,{store:Ve,children:(0,Je.jsxs)(He.Q,{loading:null,persistor:We,children:[(0,Je.jsx)(yt,{}),(0,Je.jsx)(et,{})]})}),gt=(0,n.memo)(ht)}}]);
//# sourceMappingURL=692.fe2493ea.chunk.js.map