"use strict";(self.webpackChunkreact_main=self.webpackChunkreact_main||[]).push([[692],{1692:(e,t,r)=>{r.r(t),r.d(t,{default:()=>gt});var o=r(5043),n=r(2166),s=r(7143),a=r(7710),i=r(6698),d=r(8901),l=r(1238);const c=Boolean({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_EMULATE);console.log({__emulate__:c});const u=c?"http://127.0.0.1:5001/maximprosv-server-ts/us-central1/functionsApp":"http://localhost:3005",p="/api/v1";var h=r(5103),y=r(8309);const g=(0,h.xP)({reducerPath:"api",baseQuery:(0,y.cw)({baseUrl:`${u}${p}`,prepareHeaders:(e,t)=>{let{extra:r,endpoint:o,getState:n}=t;return e.set("Content-Type","application/json;charset=UTF-8"),e.set("Authorization","anonymous"),e.set("X-Request-ID",(0,l.A)()),e}}),endpoints:e=>({})}),m=(0,a.Z0)({name:"counter",initialState:0,reducers:{incrementAction:e=>e+1,decrementAction:e=>e-1}}),f=m.reducer,{incrementAction:v,decrementAction:U}=m.actions,b=(0,a.Z0)({name:"todos",initialState:{entities:[]},reducers:{addTodoAction(e,t){let{payload:r}=t;e.entities.push(r)},addTodoPreparedAction:{reducer:(e,t)=>{let{payload:r}=t;const{id:o,text:n}=r;e.entities.push({id:o,text:n,completed:!1})},prepare:e=>({payload:{text:e,id:""+Math.random()*Date.now()}})},toggleTodoAction(e,t){let{payload:r}=t;const o=e.entities.find((e=>e.id===r));o&&(o.completed=!o.completed)}}}),{addTodoPreparedAction:A,toggleTodoAction:x,addTodoAction:C}=b.actions,P=b.reducer,S=(0,a.Z0)({name:"visibilityFilter",initialState:"SHOW_ALL",reducers:{setVisibilityFilterAction:(e,t)=>{let{payload:r}=t;return r}}}),{setVisibilityFilterAction:j}=S.actions,k=S.reducer;let L={org:"rails",repo:"rails",page:1,displayType:function(e){return e.Issues="issues",e.Comments="comments",e}({}).Issues,issueId:null};const T=(0,a.Z0)({name:"issuesDisplay",initialState:L,reducers:{displayRepo(e,t){let{payload:r}=t;const{org:o,repo:n}=r;e.org=o,e.repo=n},setCurrentPage(e,t){e.page=t.payload},setCurrentDisplayType(e,t){let{payload:r}=t;const{displayType:o,issueId:n=null}=r;e.displayType=o,e.issueId=n}}}),{displayRepo:D,setCurrentPage:E,setCurrentDisplayType:w}=T.actions,F=T.reducer;var _=r(2215),I=r(192);const R=(0,a.zD)("posts/fetchAll",(async(e,t)=>{try{const{data:e}=await _.A.get("https://jsonplaceholder.typicode.com/posts");return e}catch(r){return t.rejectWithValue(r)}})),M=(0,a.Z0)({name:"posts",initialState:{loading:!1,entities:[]},reducers:{fetchPostsStart(e){e.loading=!0},fetchPostsSuccess(e,t){let{payload:r}=t;e.entities=r,e.loading=!1},fetchPostsError(e,t){let{payload:r}=t;e.error=r,e.loading=!1}}}),{fetchPostsSuccess:O,fetchPostsError:N,fetchPostsStart:q}=M.actions,Q=M.reducer,z=e=>e.posts,$=()=>(0,I.Mz)([z,(e,t)=>t],((e,t)=>{var r;return null===(r=e.entities)||void 0===r?void 0:r.filter((e=>e.title.includes(t)))})),W=(0,I.Mz)([z,(e,t)=>t],((e,t)=>{var r;return null===(r=e.entities)||void 0===r?void 0:r.filter((e=>e.title.includes(t)))})),Z=(0,a.pU)({sortComparer:(e,t)=>e.title.localeCompare(t.title)}),V=(0,a.zD)("books/fetchAll",(async(e,t)=>{try{return await Promise.resolve([{id:"1",title:"title1"},{id:"2",title:"title2"},{id:"3",title:"title3"}])}catch(r){return t.rejectWithValue(r)}})),B=(0,a.zD)("books/updateOne",(async(e,t)=>await Promise.resolve(e))),K=Z.getInitialState({loading:!1}),H=(0,a.Z0)({name:"books",initialState:K,reducers:{removeBookAction:Z.removeOne,addBookAction:Z.addOne,updateBookAction:Z.updateOne},extraReducers:e=>{e.addCase(V.pending,((e,t)=>{e.loading=!0})),e.addCase(V.fulfilled,((e,t)=>{let{payload:r}=t;Z.upsertMany(e,r),e.loading=!1})),e.addCase(B.fulfilled,((e,t)=>{let{payload:r}=t;const{id:o,...n}=r;Z.updateOne(e,{id:o,changes:n})}))}}),X=H.reducer,{removeBookAction:Y,addBookAction:J,updateBookAction:G}=H.actions,{selectById:ee,selectIds:te,selectEntities:re,selectAll:oe,selectTotal:ne}=Z.getSelectors((e=>e.books)),se=`${u}${p}/users`,ae=(0,a.zD)("thunkUser/fetchAll",(async(e,t)=>{try{const e=await fetch(se);return await e.json()}catch(r){return t.rejectWithValue(r)}})),ie=(0,a.zD)("thunkUser/add",(async(e,t)=>{try{const t=await fetch(se,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)});return await t.json()}catch(r){return t.rejectWithValue(r)}})),de=(0,a.zD)("thunkUser/update",(async(e,t)=>{try{const t=await fetch(se,{method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)});return await t.json()}catch(r){return t.rejectWithValue(r)}})),le=(0,a.zD)("thunkUser/delete",(async(e,t)=>{try{const t=await fetch(`${se}/${e.id}`,{method:"DELETE",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)});return await t.json()}catch(r){return t.rejectWithValue(r)}}));function ce(e){return e.type.endsWith("/pending")}function ue(e){return e.type.endsWith("/fulfilled")}const pe=(0,a.pU)(),he=pe.getInitialState({loading:!1}),ye=(0,a.Z0)({name:"thunkUser",initialState:he,reducers:{},extraReducers:e=>{e.addCase(ae.fulfilled,pe.upsertMany),e.addCase(ie.fulfilled,pe.addOne),e.addCase(de.fulfilled,((e,t)=>{let{payload:r}=t;const{id:o,...n}=r;pe.updateOne(e,{id:o,changes:n})})),e.addCase(le.fulfilled,((e,t)=>{let{payload:r}=t;pe.removeOne(e,r.id)})),e.addMatcher(ce,(e=>{e.loading=!0})),e.addMatcher(ue,(e=>{e.loading=!1}))}}).reducer,{selectAll:ge}=pe.getSelectors((e=>e.thunkUser));let me=function(e){return e.Product1="product1",e.Product2="product2",e}({});const fe=(0,a.pU)(),ve=fe.getInitialState();console.log({product1InnerPropAdapterInitialState:ve});const Ue=(0,a.Z0)({name:"product/feature",initialState:null,reducers:{setProductFeatureNameAction(e,t){e.name=t.payload}}}),be=Ue.reducer,{setProductFeatureNameAction:Ae}=Ue.actions,xe=(0,a.Z0)({name:"product/product1",initialState:{},reducers:{setProduct1innerPropAction(e,t){fe.setMany(e.product1InnerProp,t.payload)},setProduct1PropAction(e,t){e.prop=t.payload}},extraReducers:e=>{e.addDefaultCase(((e,t)=>{be(e,t)}))}}),Ce=xe.reducer,{setProduct1innerPropAction:Pe,setProduct1PropAction:Se}=xe.actions,je=(0,a.pU)({}),ke=(je.getInitialState(),(0,a.Z0)({name:"product/product2",initialState:null,reducers:{setProduct2innerPropAction(e,t){je.setMany(e.product2InnerProp,t.payload)}},extraReducers:e=>{e.addDefaultCase(((e,t)=>{be(e,t)}))}})),Le=ke.reducer,{setProduct2innerPropAction:Te}=ke.actions,De=(0,a.VP)("product/setProductAction"),Ee=((0,a.VP)("product/resetProductAction"),{type:me.Product1,product1InnerProp:ve}),we=(0,a.Z0)({name:"product",initialState:Ee,reducers:{setProductTypeAction(e,t){e.type=t.payload}},extraReducers(e){e.addCase(De,((e,t)=>({...e,...t.payload}))),e.addDefaultCase(((e,t)=>((e,t)=>{switch(null===e||void 0===e?void 0:e.type){case me.Product1:return Ce(e,t);case me.Product2:return Le(e,t)}})(e,t)))}}),{setProductTypeAction:Fe}=we.actions,_e=we.reducer;let Ie=function(e){return e.XRequestId="x-request-id",e}({}),Re=function(e){return e.ConditionError="ConditionError",e}({});const Me=[],Oe=e=>e=>t=>{if((0,a.TK)(t)){var r,o,n,s,i,d,l;let e=null===(r=t.meta)||void 0===r||null===(o=r.baseQueryMeta)||void 0===o||null===(n=o.request)||void 0===n?void 0:n.headers,a=null===(s=t.meta)||void 0===s||null===(i=s.baseQueryMeta)||void 0===i||null===(d=i.response)||void 0===d?void 0:d.headers;if(e)for(let t of e)console.log("headersReq",t);if(a)for(let t of a)console.log("headersRes",t);t.error.name===Re.ConditionError||Me.includes(null===(l=t.meta.arg.arg)||void 0===l?void 0:l.endpointName)||function(e){var t,r,o,n;const s=e.meta;if(!s)return console.error("logRequestError Action doesn't contain 'meta'",e);const{request:a,response:i}=s.baseQueryMeta;if(!a&&!i)return console.error(`Request/response error: ${s.baseQueryMeta}`);const{method:d,url:l}=null!==a&&void 0!==a?a:{},{status:c,statusText:u}=null!==i&&void 0!==i?i:{},p=(null===(t=e.meta)||void 0===t||null===(r=t.baseQueryMeta)||void 0===r||null===(o=r.request)||void 0===o?void 0:o.headers)||[],h=null===(n=[...p].find((e=>{let[t]=e;return t===Ie.XRequestId})))||void 0===n?void 0:n[1];console.group(`ERROR: ${d} ${l}`),console.log(`STATUS: ${c}`),console.log(`STATUS-TEXT: ${u}`),console.log(`X-REQUEST-ID: ${h}`),s.arg&&console.log(`RTK QUERY: ${s.arg.type} ${s.arg.endpointName}`);e.payload&&(console.groupCollapsed("PAYLOAD"),console.log(JSON.stringify(e.payload,null,4)),console.groupEnd());console.groupEnd()}(t)}return e(t)};const Ne={key:"root",version:1,storage:d.A,whitelist:["todos"]},qe=(0,i.rL)(Ne,X),Qe=(0,s.HY)({counter:f,todos:P,visibilityFilter:k,books:qe,issuesDisplay:F,posts:Q,thunkUser:ye,product:_e,[g.reducerPath]:g.reducer}),ze=(0,a.U1)({reducer:Qe,preloadedState:{},middleware:e=>e({thunk:{extraArgument:{fetchPolicy:"cache-first"}},immutableCheck:!1,serializableCheck:{ignoredActions:[i.ZM,i.r2,i.Hz,i.DY,i.Cq,i.eY]}}).concat(g.middleware,Oe),devTools:!1});(0,y.$k)(ze.dispatch);const $e=ze,We=()=>(0,n.wA)(),Ze=n.d4,Ve=(0,i.GM)(ze);var Be=r(2601);function Ke(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];const a=(0,o.useMemo)(e,[e]);return(0,n.d4)((e=>a(e,...r)))}var He=r(579);const Xe=()=>{const[e,t]=(0,o.useState)(""),r=We(),{loading:s,entities:a,error:i}=(0,n.d4)(z);return(0,o.useEffect)((()=>{(async()=>{await r((async(e,t)=>{e(q());try{const{data:t}=await _.A.get("https://jsonplaceholder.typicode.com/posts");return e(O(t)),t}catch(i){throw i instanceof Error&&e(N(i)),console.error("error ",i),i}})),await r(R())})()}),[r]),i?(0,He.jsx)(He.Fragment,{children:i}):s?(0,He.jsx)(Be.A,{}):(0,He.jsxs)("ul",{children:[(0,He.jsx)("button",{onClick:()=>t((e=>e+"a")),children:"Click"}),(0,He.jsx)(Ye,{prop:e}),(0,He.jsx)(Je,{}),a.slice(0,5).map((e=>{let{id:t,title:r,body:o}=e;return(0,He.jsxs)("li",{style:{margin:10},children:[(0,He.jsx)("h5",{children:r}),(0,He.jsx)("p",{children:o})]},t)}))]})};function Ye(e){let{prop:t}=e;const r=Ke($,t),n=Ze((e=>W(e,t)));return(0,He.jsxs)(He.Fragment,{children:[n.map((e=>(0,He.jsx)(o.Fragment,{children:e.title},e.id))),r.map((e=>(0,He.jsx)(o.Fragment,{children:e.title},e.id)))]})}function Je(e){let{prop:t="a"}=e;const r=Ke($,t),n=Ze((e=>W(e,t)));return(0,He.jsxs)(He.Fragment,{children:[n.map((e=>(0,He.jsx)(o.Fragment,{children:e.title},e.id))),r.map((e=>(0,He.jsx)(o.Fragment,{children:e.title},e.id)))]})}const Ge=(0,o.memo)(Xe),et="user-list_block__yGNeD",tt="user-list_list__cbBd9",rt="user-list_listItem__5zIaF",ot="user-list_button__paQSC",nt="user_user__D2osa",st=(0,o.memo)((function(e){let{model:t,deleteUser:r,updateUser:n}=e;const{name:s}=t,[a,i]=(0,o.useState)(),[d,l]=(0,o.useState)(s),[c,u]=(0,o.useState)(!1);return a?(0,He.jsxs)("div",{className:nt,children:[(0,He.jsx)("input",{type:"text",value:d,onChange:e=>{const t=e.target.value.trim();t&&l(t)}}),(0,He.jsx)("button",{type:"button",onClick:()=>{d&&(null===n||void 0===n||n({...t,name:d}))},children:"Update"}),(0,He.jsx)("button",{onClick:()=>{i(!1)},type:"button",children:"Cancel"})]}):(0,He.jsxs)("div",{className:nt,onClick:()=>u((e=>!e)),children:[(0,He.jsx)("div",{children:s}),c&&(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("button",{onClick:()=>{i(!0)},type:"button",children:"Edit"}),(0,He.jsx)("button",{onClick:()=>null===r||void 0===r?void 0:r(t),type:"button",children:"Delete"})]})]})}));var at=r(3536);const it=g.injectEndpoints({endpoints:e=>({fetchUserList:e.query({query:()=>({url:"users"})}),fetchUser:e.query({async queryFn(e,t,r,o){let{userId:n}=e,{dispatch:s,getState:a}=t;const i=await o({url:`users/${n}`,method:"GET"});if(i.error)return i;return{data:i.data}}}),addUser:e.mutation({query:e=>{let{user:t}=e;return{url:"users",method:"POST",body:t}},async onQueryStarted(e,t){let{user:r}=e,{dispatch:o,queryFulfilled:n}=t;try{const{data:e}=await n;o(it.util.updateQueryData("fetchUserList",void 0,(t=>{t.push(e)})))}catch{console.error("addUser onQueryStarted error")}}}),addUserDebounced:e.mutation({async queryFn(e,t,r,o){var n;let{user:s,cancelDebounce:a}=e,{dispatch:i,getState:d}=t;return{data:null!==(n=await dt(s,i,o))&&void 0!==n?n:null}}}),updateUser:e.mutation({query:e=>{let{user:t}=e;return{url:"users",method:"PUT",body:t}},async onQueryStarted(e,t){let{user:r}=e,{dispatch:o,queryFulfilled:n}=t;const s=o(it.util.updateQueryData("fetchUserList",void 0,(e=>{const t=e.findIndex((e=>e.id===r.id));e[t]=r})));try{await n}catch{s.undo()}}}),deleteUser:e.mutation({async queryFn(e,t,r,o){let{dispatch:n,getState:s}=t;const a=await o({url:`users/${e.id}`,method:"DELETE"});if(a.error)return a;const i=a.data;return n(it.util.updateQueryData("fetchUserList",void 0,(t=>t.filter((t=>t.id!==e.id))))),{data:i}}})}),overrideExisting:!0}),dt=(0,at.debounce)((async(e,t,r)=>{const o=await r({url:"users",method:"POST",body:e});if(o.error)throw o.error;const n=o.data;return t(it.util.updateQueryData("fetchUserList",void 0,(e=>{e.push(n)}))),n}),1e3,{leading:!0}),lt=it.endpoints.fetchUserList.select(),ct=e=>lt(e).isLoading;const ut=()=>{const{ref:e,users:t,usersLoading:r,usersLoading2:s,addUserLoading:a,addUserDebouncedLoading:i,deleteUserLoading:d,updateUserLoading:l,onAddUser:c,onAddUserDebounced:u,onUpdateUser:p,onDeleteUser:h,onFetchUserLazy:y,onPollingStart:g,onPollingEnd:m,customInitiateFetchUserList:f}=function(){var e,t;const r=We(),[s,a]=(0,o.useState)(0),{data:i=[],isLoading:d}=it.useFetchUserListQuery(void 0,{refetchOnReconnect:!0}),l=(0,n.d4)(ct),{data:c,isLoading:u,isFetching:p}=it.useFetchUserQuery({userId:null!==(e=null===(t=i[0])||void 0===t?void 0:t.id)&&void 0!==e?e:null},{pollingInterval:s}),[h,y]=it.useLazyFetchUserQuery(),g=(0,o.useRef)(),[m,{isLoading:f}]=it.useAddUserMutation({fixedCacheKey:"userMutation"}),[v,{isLoading:U}]=it.useAddUserDebouncedMutation({fixedCacheKey:"userMutation"}),[b,{isLoading:A}]=it.useDeleteUserMutation({fixedCacheKey:"userMutation"}),[x,{isLoading:C}]=it.useUpdateUserMutation({fixedCacheKey:"userMutation"}),P=(0,o.useRef)(null),S=(0,o.useCallback)((()=>{var e;const t=null===(e=P.current)||void 0===e?void 0:e.value.trim();t&&m({user:{name:t}})}),[m]),j=(0,o.useCallback)((()=>{var e;const t=null===(e=P.current)||void 0===e?void 0:e.value.trim();t&&v({user:{name:t}})}),[v]),k=(0,o.useCallback)((async()=>{var e,t,r;null===(e=g.current)||void 0===e||e.abort(),g.current=h({userId:null!==(t=null===(r=i[0])||void 0===r?void 0:r.id)&&void 0!==t?t:null},!0);const o=await g.current;console.log({lazyUser:o})}),[h,i]),L=(0,o.useCallback)((async e=>{const t=await x({user:e}).unwrap().catch((e=>console.log(e)));console.log({updatedUser:t})}),[x]),T=(0,o.useCallback)((async e=>{let t;t=await b(e),"error"in t&&console.error("delete use error"),console.log(t)}),[b]);(0,o.useEffect)((()=>{console.log({user:c,userLoading:u,userFetching:p})}),[c,u,p]),(0,o.useEffect)((()=>{console.log({addUserLoading:f,deleteUserLoading:A,updateUserLoading:C,addUserDebouncedLoading:U})}),[f,A,C,U]),(0,o.useEffect)((()=>{console.log("in useEffect ",{lazyUser:y})}),[y]);const D=(0,o.useCallback)((async()=>a(1e3)),[]),E=(0,o.useCallback)((async()=>a(0)),[]),w=(0,o.useCallback)((async()=>{const e=await r(it.endpoints.fetchUserList.initiate());console.log({res:e})}),[r]);return{ref:P,users:i,usersLoading:d,usersLoading2:l,addUserLoading:f,deleteUserLoading:A,updateUserLoading:C,addUserDebouncedLoading:U,onAddUser:S,onAddUserDebounced:j,onDeleteUser:T,onUpdateUser:L,onFetchUserLazy:k,onPollingStart:D,onPollingEnd:E,customInitiateFetchUserList:w}}();return(0,He.jsxs)(He.Fragment,{children:[(0,He.jsxs)("div",{children:[(0,He.jsx)("button",{type:"button",onClick:f,children:"custom trigger initiate"}),(0,He.jsx)("button",{type:"button",className:ot,onClick:g,children:"Start Polling"}),(0,He.jsx)("button",{type:"button",className:ot,onClick:m,children:"End Polling"}),(0,He.jsx)("button",{type:"button",className:ot,onClick:y,children:"Fetch Lazy User)"})]}),(0,He.jsxs)("div",{className:et,children:[(0,He.jsx)("input",{type:"text",ref:e,placeholder:"User Name"}),(0,He.jsx)("button",{type:"button",className:ot,onClick:c,children:"Add user"}),(0,He.jsx)("button",{type:"button",className:ot,onClick:u,children:"Add Debounced user"})]}),(0,He.jsx)("div",{className:et,children:s||a||d||l||i?(0,He.jsx)(He.Fragment,{children:"Loading..."}):(0,He.jsx)("ul",{className:tt,children:t.map((e=>(0,He.jsx)("li",{className:rt,children:(0,He.jsx)(st,{model:e,updateUser:p,deleteUser:h})},e.id)))})})]})},pt=(0,o.memo)(ut);var ht=r(4730);const yt=()=>(0,He.jsx)(n.Kq,{store:$e,children:(0,He.jsxs)(ht.Q,{loading:null,persistor:Ve,children:[(0,He.jsx)(pt,{}),(0,He.jsx)(Ge,{})]})}),gt=(0,o.memo)(yt)}}]);
//# sourceMappingURL=692.40ad5897.chunk.js.map